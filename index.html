<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Smart Running Companion</title>

<style>
* { box-sizing: border-box; margin: 0; padding: 0; font-family: sans-serif; }

body {
  background: linear-gradient(135deg,#dbeafe,#f0f9ff);
  min-height: 100vh;
  padding: 20px;
}

.container {
  max-width: 420px;
  margin: auto;
}

.card {
  background: white;
  border-radius: 24px;
  padding: 20px;
  margin-bottom: 20px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.08);
}

.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.time {
  font-size: 20px;
  font-weight: bold;
}

.timer {
  font-size: 48px;
  text-align: center;
  margin: 20px 0;
  font-weight: bold;
}

.stats {
  display: flex;
  justify-content: space-between;
  text-align: center;
  margin-top: 10px;
}

.stats div {
  flex: 1;
}

button {
  border: none;
  padding: 14px;
  border-radius: 14px;
  font-weight: bold;
  cursor: pointer;
}

.start-btn {
  width: 100%;
  background: #2563eb;
  color: white;
  margin-top: 10px;
}

.stop-btn {
  background: #111;
  color: white;
}

.sos-btn {
  background: red;
  color: white;
  width: 70px;
  height: 70px;
  border-radius: 20px;
}

.controls {
  display: flex;
  gap: 10px;
  margin-top: 10px;
}

input {
  width: 100%;
  padding: 8px;
  border-radius: 10px;
  border: 1px solid #ddd;
  margin-top: 5px;
}

.bpm {
  font-size: 36px;
  color: red;
  font-weight: bold;
}

.danger {
  background: #dc2626 !important;
  color: white;
}

.footer-fixed {
  position: fixed;
  bottom: 20px;
  left: 0;
  right: 0;
  max-width: 420px;
  margin: auto;
}
</style>
</head>

<body>
<div class="container">

  <div class="card header">
    <div>
      <h2>Smart Companion</h2>
      <small>Running Mode</small>
    </div>
    <div class="time" id="clock">--:--:--</div>
  </div>

  <div class="card">
    <h3>Health Profile</h3>
    <label>Weight (kg)</label>
    <input type="number" id="weight" value="75">
    <label>Height (cm)</label>
    <input type="number" id="height" value="175">
    <button class="start-btn" onclick="calculateBMI()">Calculate</button>
    <p id="bmiResult" style="margin-top:10px;"></p>
  </div>

  <div class="card">
    <h3>Session</h3>
    <div class="timer" id="timer">00:00:00</div>
    <div class="stats">
      <div>
        <small>Distance</small>
        <div id="distance">0.00 km</div>
      </div>
      <div>
        <small>Steps</small>
        <div id="steps">0</div>
      </div>
      <div>
        <small>Energy</small>
        <div id="energy">0 kcal</div>
      </div>
    </div>
  </div>

  <div class="card" id="heartCard">
    <h3>Heart Rate</h3>
    <div class="bpm" id="bpm">110 BPM</div>
  </div>

  <div class="card">
    <h3>Community Report</h3>
    <input type="text" id="reportText" placeholder="รายงานจุดเสี่ยง...">
    <button class="start-btn" onclick="analyzeReport()">Send Report</button>
  </div>

</div>

<div class="footer-fixed">
  <div class="controls">
    <button class="sos-btn" onclick="alert('SOS ACTIVATED')">SOS</button>
    <button id="toggleBtn" class="start-btn" onclick="toggleRun()">START RUNNING</button>
  </div>
</div>

<script>
let isRunning = false;
let seconds = 0;
let distance = 0;
let steps = 0;
let bpm = 110;
let interval;

function updateClock(){
  const now = new Date();
  document.getElementById("clock").innerText =
    now.toLocaleTimeString('th-TH');
}
setInterval(updateClock,1000);

function formatTime(s){
  let h = String(Math.floor(s/3600)).padStart(2,'0');
  let m = String(Math.floor((s%3600)/60)).padStart(2,'0');
  let sec = String(s%60).padStart(2,'0');
  return `${h}:${m}:${sec}`;
}

function toggleRun(){
  const btn = document.getElementById("toggleBtn");
  if(!isRunning){
    isRunning = true;
    btn.innerText = "STOP SESSION";
    btn.classList.remove("start-btn");
    btn.classList.add("stop-btn");

    interval = setInterval(()=>{
      seconds++;
      distance += 0.002;
      steps += Math.random() > 0.3 ? 2 : 1;
      bpm = Math.min(175, bpm + (Math.random()>0.5?1:-1));

      document.getElementById("timer").innerText = formatTime(seconds);
      document.getElementById("distance").innerText = distance.toFixed(2)+" km";
      document.getElementById("steps").innerText = steps;
      document.getElementById("energy").innerText = Math.floor(distance*65)+" kcal";
      document.getElementById("bpm").innerText = bpm+" BPM";

      if(bpm > 165){
        document.getElementById("heartCard").classList.add("danger");
      }
    },1000);

  } else {
    isRunning = false;
    clearInterval(interval);
    btn.innerText = "START RUNNING";
    btn.classList.remove("stop-btn");
    btn.classList.add("start-btn");
  }
}

function calculateBMI(){
  const w = parseFloat(document.getElementById("weight").value);
  const h = parseFloat(document.getElementById("height").value)/100;
  const bmi = (w/(h*h)).toFixed(1);
  document.getElementById("bmiResult").innerText = "BMI: "+bmi;
}

function analyzeReport(){
  const text = document.getElementById("reportText").value;
  const dangerWords = ["มืด","อันตราย","เปลี่ยว","สุนัข","ไฟ"];
  const isDanger = dangerWords.some(w=>text.includes(w));

  if(isDanger){
    alert("⚠️ ตรวจพบจุดเสี่ยง ระบบเพิ่มระดับความระวัง");
  } else {
    alert("รายงานถูกบันทึกแล้ว");
  }
}
</script>

</body>
</html>
